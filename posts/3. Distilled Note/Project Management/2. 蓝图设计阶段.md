## 二、蓝图设计阶段

蓝图设计阶段主要的角色有：
1. Data Architect / BI Architect 数据架构师 / BI架构师
	- 设计数据仓库和BI系统的**整体架构**，包括硬件、软件、网络和数据存储等方面，以确保系统具有良好的**性能**、**可扩展性**和**安全性**。
	- 制定数据仓库和BI系统的**技术标准**和**最佳实践**，为项目团队提供**技术指导**。
	- 评估和选择**合适的技术和工具**，包括数据库管理系统、ETL工具、报表工具等。
	- 与项目经理和需求分析师合作，确保**技术架构满足业务需求**。
	- 与数据建模师合作，确保**数据模型与技术架构**相匹配。
	- 协助数据仓库管理员进行**系统性能调优、故障排查**等工作。
	- 与ETL开发人员、报表开发人员和数据分析师等其他团队成员保持良好的沟通，确保**技术架构能够满足各种需求**。
2. Data Modeler 数据建模师
	1. [[星型模型设计]]
	2. 和BA紧密配合，确保**模型符合业务需求**

### 1. 整体架构与技术方案设计

- 硬件：服务器配置
- 软件：ETL工具选型、数仓选型、BI选型等
- 网络：网络环境设计

**服务器配置**
- 多少台服务器
- 每台服务器所在的网络环境
- 每台服务器承载的APP及功能
- 数据流向与网络端口

**数仓管理平台选型：**
- 

- [[数仓工具选型]]
- [[ETL工具选型]]
- [[Olap引擎选型]]
- [[BI工具选型]]

**数仓数据库选型：**
数据库：
- SQL Server
- MySQL
大数据引擎：
- Max Compute




Power BI 部署方式
* Power BI Desktop
* Power BI Pro
* Power BI Embedded / Premium
* Power BI Report Server

### 2. 数仓技术标准设计

#ToDo 下面的标准都需要定制一下

#### 2.1 数据模型设计标准

#### 2.2 数仓数据获取标准

#### 2.3 数仓分层标准

#### 2.4 数仓存储过程标准

### 2. 数据处理原则

#### 2.1 可持续

Power Query是一个非常非常好用的数据处理工具，主要归功于他的UI界面的设计，轻便易懂，就连最白的小小白也能瞬间上手。

但同时它的低门槛带来了一个严重的问题，大家都“自认为”会用Power Query了，没有人去看背后的代码，甚至中间的实现逻辑都懒得梳理…… 一些朋友给我看他们的处理方式时，在那里点点点，然后说，“瞧，这不是出来了，为什么换一个数据源就不对了？”。

这个问题问到了**Power Query的本质**，他是BI系统展示数据前对数据进行的处理，因此这里的处理必须实现自动化。这种处理与大学做的一次性数分析项目不一样，必须注意一个原则：

> Power Query中的所有处理都是在制作Pipeline，没有什么是一次性的。

什么样的数据处理是可持续的？只要做到以下几点，便算是可持续。

* 多时间段数据更新无BUG（测试用数据应与开发用数据不同）

* 非关键字段增减无BUG（逆透视也许会出问题）

那我们如何做到可持续性呢？最简单的原则：检查每一步的数据处理逻辑及代码，是否在数据更新的情况下通用。



#### 2.2 易维护性

这里的易维护性分为两部分，分别是**mapping表的维护**与**代码的维护**。

mapping表如果需要人来维护的话，尽量将mapping做的越简单越好，这里会涉及到：

* 一对多关系匹配列：内容上没什么难的。但一定要命名清楚，说明这一列就是用来做一对多匹配关系的
* <span style="color:#D93124"> 多对多关系匹配列</span>：这种关系会包含重复项、空值等，对于PBI初学者来说都不算简单。如果维度表中包含此类关系，请务必多次说明为什么并写说明页，否则看一次晕一次
* 层级：依然好理解，层级对应的排序需要跟在层级后面以防漏掉
* 计算标识：这类标识是为了在BI中进行计算而专门设立的，业务人员不知道为什么维护这个，因此一定要沟通清楚，或在Excel中增加说明页面

代码的维护通常来说很简单，我们希望将自己的代码写的更加模块化，更加有逻辑性，并且增加注释让大家看得懂。但在Power Query里，没有谁每一次都是直接进到高级编辑器去读代码的。因此，以下方式可以帮助我们让数据处理的可读性更高：

* 查询窗口
  * 文件夹分类
  * 命名好事实表维度表及其作用
* 步骤窗口
  * 如果在做非常规处理，有可能让大家看不懂的情况，将步骤重命名，说明用意
  * 可以用一些下划线等，对数据处理步骤做层级分类
* 高级编辑窗口
  * 可以直接在里面写注释，这里的注释会显示到步骤窗口的步骤中，悬停即可看到



#### 2.3 唯一性

唯一性其实是很常见的原则了，以下举例说明唯一性如何遵循

* 同一个查询不要查多次，能引用则不要复制
* 如果碰到复杂的数据处理逻辑，用流程图画出来，不要想到哪儿就查到哪儿，那样重复性也会很高
* 同一个复杂步骤尽量不要重复多次，如果重复多次的话尽量在Power Query里写好function，这样可复用也容易读

#### 数仓ETL Pipeline标准

- BI Dax 标准

### 3. 最佳实践方案
#ToDo [[最佳实践方案]] 你需要把最佳实践进行分类，做出一个框架，并把目前已有的Dax最佳方案放进来。


### 4. 数据模型搭建

数仓的数据模型搭建，应用的是[[星型模型设计]]理论。在该理论框架的指导下，去设计维度与事实表。
