---
title: BI架构调整
author: air.yan
date: 2021-08-07 22:33:25
updated:
index_img: /img/index_img/architecture.png
category: 
   - 性能优化
typora-root-url: ..\..\public
---
![Power BI Architecture](/img/index_img/architecture.png)

# BI架构调整

文章尚未完成，待更新……

<!--more-->

## 一、为什么要做架构调整

我经常和做BI的小伙伴们讲，Dax分析语言理论上是万能的，只要你能想得到的逻辑，它都能给你用它独有的方式实现。在我做BI分析这几年中经历的现实项目中也是如此，只要你够强，脑洞够大，那就没有什么是你写不出来的。

但问题就此出现：既然Dax语言如此强大，如此万能，我们是否可以随意应用个**星型模型（Star Model）**或**雪花模型（Snow Model）**，然后打开脑洞并用万能的dax解决一切呢？

嗯…… 只要你的电脑/服务器配置够好，理论上是完全可以的，但就算是理论上说的过去，理论上也有前提的啊，前提是你不要写出什么惊天10层循环SUMX，无敌九连SWITCH套娃，疯狂物化虚拟表…… 总之，不要太离谱。

我们实际情况往往是有成本限制的，比如本地开发人员的电脑配置，再比如云端PBI服务上限，数据网关服务器配置等等。这些资源成本的限制，直接将纸上谈兵的理论家打醒，用现实情况告诉你，当你触碰到底线时，性能将决定一切！

当我们触碰到性能的天花板时，能否对性能优化到红线以下将直接决定你BI项目的成功或失败。换句话说，在已有资源的前提下，一个连跑都跑不动的BI，我们要你何用？

关于性能优化的话题，网上已有不少PBI攻略，但却少见性能向的讲解，Dax圣经一书中也仅在最后几章节中提到。实际上，性能优化是Dax学习中的巅峰，它很重要，非常重要，但本篇文章就是这么任性，不讲Dax性能优化。

当在有限的资源下遇到性能问题，实际上我们有两种解决方案：
1. 优化模型性能
2. 提高性能红线

我们将在本文中探讨不同BI架构的性能极限，以及当触碰到这些架构的极限时，该如何通过调整架构来提高性能红线，突破极限。

## 二、定位性能天花板

要解决性能天花板的问题，首先我们要了解天花板在哪儿，限制分别是多少。

我们在做BI报告时面对的限制主要是两方面的，一是时间限制，二是内存限制，三是储存空间限制。当时间限制被超出时，会极大降低用户体验，或无法进行数据刷新；当内存限制或储存限制被超出时BI报告将无法正常运行。

### 1. 报告储存
* 因素：报告大小
* 限制：
   * 单个数据集有1G上限限制，简单理解，PBIX文件不可超过1G（可通过Premium等不同方案提升）
   * 单个工作区有10G上限限制

官方文档连接请点击→[这里](https://docs.microsoft.com/en-us/power-bi/admin/service-admin-manage-your-data-storage-in-power-bi#:~:text=)。

### 2. 数据刷新
* 因素：
    * 数据源读取速度
    * Power Query
    * Dax生成的列、表
    * 其他（网关服务器性能等）
* 时限：1小时内（Pro）
* 内存限制：
   * 查看报告时的内存限制：由度量值复杂度决定
   * 刷新PBI数据集的内存限制：不同部署方式不同

### 3. 报告查看
* 因素：度量值、可视化渲染
* 时限：5秒以下
* 内存：
   * 本地开发文件内存上限既是电脑本身内存上限（一般不超16G）

## 三、BI架构

### 1. 星型模型建模

### 2. 复杂模型 + Dax生成结果表

### 3. 混合模型式